axis.title.x = element_text(size=8, color = "black"),
axis.title.y = element_text( size=8, color = "black"),
plot.title = element_text(hjust = 0.5, color = "black", size = 10),
legend.title.align = 0,
plot.background = element_rect(fill='white'),
legend.text=element_text(size=7, color = "black"),
legend.title =element_text(size=8, color = "black"),
legend.background = element_rect(fill = "white")) +
#geom_vline(xintercept = c(2.5,4.5), color="black", size=0.3) +
scale_x_discrete(limits=c("Early", "Active", "Advanced")) +
scale_fill_manual(values = c("royalblue1", "tan3", "gray60"),
name = "Source", labels = c("Skin", "Soil", "Unknown")) +
labs(x = "Decomposition Stage", y = "Predicted Microbial Source Proportion")
ggplot(st_long_prop_spring, aes(x = AltSampleID, y = Source_proportion, fill = variable)) +
geom_bar(stat = 'identity') +
theme_bw() +
facet_grid(. ~ Facility) +
theme(panel.grid.major = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.text.x = element_text(size=7, color = "black", angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size=7, color = "black", angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(size=8, color = "black"),
axis.title.y = element_text( size=8, color = "black"),
plot.title = element_text(hjust = 0.5, color = "black", size = 10),
legend.title.align = 0,
plot.background = element_rect(fill='white'),
legend.text=element_text(size=7, color = "black"),
legend.title =element_text(size=8, color = "black"),
legend.background = element_rect(fill = "white")) +
#geom_vline(xintercept = c(2.5,4.5), color="black", size=0.3) +
scale_x_discrete(limits=c("Early", "Active", "Advanced")) +
scale_fill_manual(values = c("royalblue1", "tan3", "gray60"),
name = "Community", labels = c("Initial Skin", "Initial Soil", "New")) +
labs(x = "Decomposition Stage", y = "Predicted Microbial Source Proportion")
ggplot(st_long_prop_spring, aes(x = AltSampleID, y = Source_proportion, fill = variable)) +
geom_bar(stat = 'identity') +
theme_bw() +
facet_grid(. ~ Facility) +
theme(panel.grid.major = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.text.x = element_text(size=7, color = "black", angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size=7, color = "black", angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(size=8, color = "black"),
axis.title.y = element_text( size=8, color = "black"),
plot.title = element_text(hjust = 0.5, color = "black", size = 10),
legend.title.align = 0,
plot.background = element_rect(fill='white'),
legend.text=element_text(size=7, color = "black"),
legend.title =element_text(size=8, color = "black"),
legend.background = element_rect(fill = "white")) +
#geom_vline(xintercept = c(2.5,4.5), color="black", size=0.3) +
scale_x_discrete(limits=c("Early", "Active", "Advanced")) +
scale_fill_manual(values = c("royalblue1", "tan3", "gray60"),
name = "Community", labels = c("Initial Skin", "Initial Soil", "Unknown")) +
labs(x = "Decomposition Stage", y = "Predicted Microbial Source Proportion")
ggplot(st_long_prop_spring, aes(x = AltSampleID, y = Source_proportion, fill = variable)) +
geom_bar(stat = 'identity') +
theme_bw() +
facet_grid(. ~ Facility) +
theme(panel.grid.major = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.text.x = element_text(size=7, color = "black", angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size=7, color = "black", angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(size=8, color = "black"),
axis.title.y = element_text( size=8, color = "black"),
plot.title = element_text(hjust = 0.5, color = "black", size = 10),
legend.title.align = 0,
plot.background = element_rect(fill='white'),
legend.text=element_text(size=7, color = "black"),
legend.title =element_text(size=8, color = "black"),
legend.background = element_rect(fill = "white")) +
#geom_vline(xintercept = c(2.5,4.5), color="black", size=0.3) +
scale_x_discrete(limits=c("Early", "Active", "Advanced")) +
scale_fill_manual(values = c("royalblue1", "tan3", "black"),
name = "Community", labels = c("Initial Skin", "Initial Soil", "Unknown")) +
labs(x = "Decomposition Stage", y = "Predicted Microbial Source Proportion")
ggplot(st_long_prop_spring, aes(x = AltSampleID, y = Source_proportion, fill = variable)) +
geom_bar(stat = 'identity') +
theme_bw() +
facet_grid(. ~ Facility) +
theme(panel.grid.major = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.text.x = element_text(size=7, color = "black", angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size=7, color = "black", angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(size=8, color = "black"),
axis.title.y = element_text( size=8, color = "black"),
plot.title = element_text(hjust = 0.5, color = "black", size = 10),
legend.title.align = 0,
plot.background = element_rect(fill='white'),
legend.text=element_text(size=7, color = "black"),
legend.title =element_text(size=8, color = "black"),
legend.background = element_rect(fill = "white")) +
#geom_vline(xintercept = c(2.5,4.5), color="black", size=0.3) +
scale_x_discrete(limits=c("Early", "Active", "Advanced")) +
scale_fill_manual(values = c("royalblue1", "tan3", "gray80"),
name = "Community", labels = c("Initial Skin", "Initial Soil", "Unknown")) +
labs(x = "Decomposition Stage", y = "Predicted Microbial Source Proportion")
ggplot(st_long_prop_spring, aes(x = AltSampleID, y = Source_proportion, fill = variable)) +
geom_bar(stat = 'identity') +
theme_bw() +
facet_grid(. ~ Facility) +
theme(panel.grid.major = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.text.x = element_text(size=7, color = "black", angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size=7, color = "black", angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(size=8, color = "black"),
axis.title.y = element_text( size=8, color = "black"),
plot.title = element_text(hjust = 0.5, color = "black", size = 10),
legend.title.align = 0,
plot.background = element_rect(fill='white'),
legend.text=element_text(size=7, color = "black"),
legend.title =element_text(size=8, color = "black"),
legend.background = element_rect(fill = "white")) +
#geom_vline(xintercept = c(2.5,4.5), color="black", size=0.3) +
scale_x_discrete(limits=c("Early", "Active", "Advanced")) +
scale_fill_manual(values = c("royalblue1", "tan3", "gray40"),
name = "Community", labels = c("Initial Skin", "Initial Soil", "Unknown")) +
labs(x = "Decomposition Stage", y = "Predicted Microbial Source Proportion")
ggplot(st_long_prop_spring, aes(x = AltSampleID, y = Source_proportion, fill = variable)) +
geom_bar(stat = 'identity') +
theme_bw() +
facet_grid(. ~ Facility) +
theme(panel.grid.major = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.text.x = element_text(size=7, color = "black", angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size=7, color = "black", angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(size=8, color = "black"),
axis.title.y = element_text( size=8, color = "black"),
plot.title = element_text(hjust = 0.5, color = "black", size = 10),
legend.title.align = 0,
plot.background = element_rect(fill='white'),
legend.text=element_text(size=7, color = "black"),
legend.title =element_text(size=8, color = "black"),
legend.background = element_rect(fill = "white")) +
#geom_vline(xintercept = c(2.5,4.5), color="black", size=0.3) +
scale_x_discrete(limits=c("Early", "Active", "Advanced")) +
scale_fill_manual(values = c("royalblue1", "tan3", "gray60"),
name = "Community", labels = c("Initial Skin", "Initial Soil", "Unknown")) +
labs(x = "Decomposition Stage", y = "Predicted Microbial Source Proportion")
ggplot(st_long_prop_spring, aes(x = AltSampleID, y = Source_proportion, fill = variable)) +
geom_bar(stat = 'identity') +
theme_bw() +
facet_grid(. ~ Facility) +
theme(panel.grid.major = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.text.x = element_text(size=7, color = "black", angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size=7, color = "black", angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(size=8, color = "black"),
axis.title.y = element_text( size=8, color = "black"),
plot.title = element_text(hjust = 0.5, color = "black", size = 10),
legend.title.align = 0,
plot.background = element_rect(fill='white'),
legend.text=element_text(size=7, color = "black"),
legend.title =element_text(size=8, color = "black"),
legend.background = element_rect(fill = "white")) +
#geom_vline(xintercept = c(2.5,4.5), color="black", size=0.3) +
scale_x_discrete(limits=c("Early", "Active", "Advanced")) +
scale_fill_manual(values = c("royalblue1", "tan3", "gray50"),
name = "Community", labels = c("Initial Skin", "Initial Soil", "Unknown")) +
labs(x = "Decomposition Stage", y = "Predicted Microbial Source Proportion")
ggsave("/Users/Zach/Dropbox/PMI_3_analyses/multi-omics_data/figures/ST2_combined_facility_plot.png",dpi=300, width=5, height=4, units="in")
# combined
detach("package:ggpubr", unload = TRUE)
detach("package:dplyr", unload = TRUE)
st_spring <- read.csv("~/Dropbox/PMI_3_analyses/multi-omics_data/amplicon/16S/st2/combined_facility_mixing_proportions_no_face.csv")
st_spring <- ddply(melt(st_spring, id.vars = c('SampleID','Decomposition.Stage',	'Facility',	'Location',	'AltSampleID')), .(SampleID))
library(dplyr)   ### LOAD THIS HERE, NOT ABOVE
st_long_prop_spring <- st_spring %>% group_by(Facility,AltSampleID,variable) %>% summarise(Source_proportion = mean(value))
st_long_prop_spring$AltSampleID = factor(st_long_prop_spring$AltSampleID,levels = c("Early", "Active",  "Advanced"))
ggplot(st_long_prop_spring, aes(x = AltSampleID, y = Source_proportion, fill = variable)) +
geom_bar(stat = 'identity') +
theme_bw() +
facet_grid(. ~ Facility) +
theme(panel.grid.major = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.text.x = element_text(size=7, color = "black", angle = 45, hjust = 1, vjust = 1),
axis.text.y = element_text(size=7, color = "black", angle = 0, hjust = 0.5, vjust = 0.5),
axis.title.x = element_text(size=8, color = "black"),
axis.title.y = element_text( size=8, color = "black"),
plot.title = element_text(hjust = 0.5, color = "black", size = 10),
legend.title.align = 0,
plot.background = element_rect(fill='white'),
legend.text=element_text(size=7, color = "black"),
legend.title =element_text(size=8, color = "black"),
legend.background = element_rect(fill = "white")) +
#geom_vline(xintercept = c(2.5,4.5), color="black", size=0.3) +
scale_x_discrete(limits=c("Early", "Active", "Advanced")) +
scale_fill_manual(values = c("royalblue1", "tan3", "gray50"),
name = "Community", labels = c("Initial Skin", "Initial Soil", "Unknown")) +
labs(x = "Decomposition Stage", y = "Predicted Microbial Source Proportion")
ggsave("/Users/Zach/Dropbox/PMI_3_analyses/multi-omics_data/figures/ST2_combined_facility_noface_plot.png",dpi=300, width=5, height=4, units="in")
library(ggplot2)
library(tidyverse)
library(scales)
library(qiime2R)
library(cowplot)
library(Rmisc)
library(dplyr)
library(viridis)
library(ggpmisc)
library(ggsignif)
library(FSA)
library(hrbrthemes)
library(car)
library(lsmeans)
library(reshape2)
library(multcomp)
library(lme4)
library(lmerTest)
library(merTools)
library(redres)
setwd("~/Dropbox/PMI_3_analyses/multi-omics_data/figures")
# functions
data_summary <- function(data, varname, groupnames){
require(dplyr)
summary_func <- function(x, col){
c(mean = mean(x[[col]], na.rm=TRUE),
sd = sd(x[[col]], na.rm=TRUE))
}
grouping<-group_by(data, groupnames)
data_sum<-ddply(grouping, varname)
data_sum <- rename(data_sum, c("mean" = varname))
return(data_sum)
}
# ALL community size 20
comp = read.table('/Users/Zach/Dropbox/PMI_3_analyses/multi-omics_data/shotgun/qiime2-2020-8/MAG/cooccurances/all20_stages_global.tsv', sep= '\t', header=TRUE)
comp$stage <- factor(comp$stage,levels = c("early", "active", "advanced"))
p1=ggplot(comp, aes(x=stage, y=as.numeric(mro), fill=Facility)) +
geom_boxplot(width=0.65,outlier.shape=21, outlier.size=1.5) +
facet_wrap(~Facility) +
ylim(0.58,0.70) +
labs(x="", y="Metabolic Competition (MRO)") +
theme_bw() +
guides(fill=guide_legend(override.aes=list(shape=21,size=1.5,linetype=0))) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none") +
scale_fill_manual(name='Facility', values=c('CMU'='mediumorchid4', 'SHSU'='royalblue3', 'UTK'='mediumseagreen')) +
scale_colour_manual(name='Facility', values=c('CMU'='mediumorchid4', 'SHSU'='royalblue3', 'UTK'='mediumseagreen'))
p1
p2=ggplot(comp, aes(x=stage, y=as.numeric(mip), fill=Facility)) +
geom_boxplot(width=0.65,outlier.shape=21, outlier.size=1.5) +
facet_wrap(~Facility) +
ylim(20,40) +
labs(x="Decomposition Stage", y="Metabolic Cooperation (MIP)") +
theme_bw() +
guides(fill=guide_legend(override.aes=list(shape=21,size=1.5,linetype=0))) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none") +
scale_fill_manual(name='Facility', values=c('CMU'='mediumorchid4', 'SHSU'='royalblue3', 'UTK'='mediumseagreen')) +
scale_colour_manual(name='Facility', values=c('CMU'='mediumorchid4', 'SHSU'='royalblue3', 'UTK'='mediumseagreen'))
p2
p3 = plot_grid(p2, p1, ncol = 1, nrow = 2, align = "v")
p3
save_plot("smetana-global20-boxplot.png", p3, base_height = 6, base_width = 6,dpi=600)
p1=ggplot(comp, aes(x=stage, y=as.numeric(mro), fill=Facility)) +
geom_boxplot(width=0.65,outlier.shape=21, outlier.size=1.5) +
facet_wrap(~Facility) +
ylim(0.58,0.70) +
labs(x="Decomposition Stage", y="Metabolic Competition (MRO)") +
theme_bw() +
guides(fill=guide_legend(override.aes=list(shape=21,size=1.5,linetype=0))) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none") +
scale_fill_manual(name='Facility', values=c('CMU'='mediumorchid4', 'SHSU'='royalblue3', 'UTK'='mediumseagreen')) +
scale_colour_manual(name='Facility', values=c('CMU'='mediumorchid4', 'SHSU'='royalblue3', 'UTK'='mediumseagreen'))
p1
p2=ggplot(comp, aes(x=stage, y=as.numeric(mip), fill=Facility)) +
geom_boxplot(width=0.65,outlier.shape=21, outlier.size=1.5) +
facet_wrap(~Facility) +
ylim(20,40) +
labs(x="", y="Metabolic Cooperation (MIP)") +
theme_bw() +
guides(fill=guide_legend(override.aes=list(shape=21,size=1.5,linetype=0))) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none") +
scale_fill_manual(name='Facility', values=c('CMU'='mediumorchid4', 'SHSU'='royalblue3', 'UTK'='mediumseagreen')) +
scale_colour_manual(name='Facility', values=c('CMU'='mediumorchid4', 'SHSU'='royalblue3', 'UTK'='mediumseagreen'))
p2
p3 = plot_grid(p2, p1, ncol = 1, nrow = 2, align = "v")
p3
save_plot("smetana-global20-boxplot.png", p3, base_height = 6, base_width = 6,dpi=600)
library(ggplot2)
library(tidyverse)
library(scales)
library(qiime2R)
library(cowplot)
library(Rmisc)
library(dplyr)
library(viridis)
library(ggpmisc)
library(ggsignif)
library(FSA)
library(hrbrthemes)
library(car)
library(lsmeans)
library(reshape2)
library(multcomp)
library(lme4)
library(lmerTest)
library(merTools)
library(redres)
library(ggrepel)
library(forcats)
library(tidytext)
setwd("~/Dropbox/PMI_3_analyses/multi-omics_data/amplicon/16S/longitudinal/soilhip")
SHSU_vol = read.table("pc_SHSU_vol.tsv", header = TRUE, sep = "\t")
p1=ggplot(SHSU_vol, aes(x=add_0c, y= Axis1, color=sample_site)) +
#scale_y_continuous(breaks=pretty_breaks()) +
#stat_summary(geom="errorbar", fun.data=mean_se, width=0, orientation="x") +
stat_summary(geom="line", fun.data=mean_se, orientation="x", size=0.5) +
#stat_summary(geom="point", fun.data=mean_se, orientation="x", size=1) +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "ADD", y = "Axis 1 Distance", title="SHSU") +
guides(color = guide_legend(override.aes = list(size=2))) +
theme_bw() +
xlim(0,650) +
theme(axis.text=element_text(size=8),
axis.title.x = element_blank(),
axis.title=element_text(size=9),
plot.title = element_text(size=12, hjust = 0.5),
strip.text = element_text(size=6.5),
legend.text = element_text(size=7),
legend.title = element_text(size=7, hjust = 0.5),
legend.position = c(0.929, 0.22),
legend.direction = "vertical",
legend.key.height = unit(0.01, "cm"),
legend.key.width = unit(0.01, "cm"),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="white")) +
scale_colour_manual(name='Sample Site', values=c('soil.hip'='royalblue3', 'soil.control'='gray20')) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)+2*(sd(SHSU_vol$Axis1)), linetype="dashed") +
geom_hline(yintercept=mean(SHSU_vol$Axis1)-2*(sd(SHSU_vol$Axis1)), linetype="dashed")
p1
p1=ggplot(SHSU_vol, aes(x=add_0c, y= Axis1, color=sample_site)) +
#scale_y_continuous(breaks=pretty_breaks()) +
#stat_summary(geom="errorbar", fun.data=mean_se, width=0, orientation="x") +
stat_summary(geom="line", fun.data=mean_se, orientation="x", size=0.5) +
#stat_summary(geom="point", fun.data=mean_se, orientation="x", size=1) +
#geom_smooth(method = "lm", se = FALSE) +
labs(x = "ADD", y = "Axis 1 Distance", title="SHSU") +
guides(color = guide_legend(override.aes = list(size=2))) +
theme_bw() +
xlim(0,650) +
theme(axis.text=element_text(size=8),
axis.title.x = element_blank(),
axis.title=element_text(size=9),
plot.title = element_text(size=12, hjust = 0.5),
strip.text = element_text(size=6.5),
legend.text = element_text(size=7),
legend.title = element_text(size=7, hjust = 0.5),
legend.position = c(0.929, 0.22),
legend.direction = "vertical",
legend.key.height = unit(0.01, "cm"),
legend.key.width = unit(0.01, "cm"),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="white")) +
scale_colour_manual(name='Sample Site', values=c('soil.hip'='royalblue3', 'soil.control'='gray20')) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)+2*(sd(SHSU_vol$Axis1)), linetype="dashed") +
geom_hline(yintercept=mean(SHSU_vol$Axis1)-2*(sd(SHSU_vol$Axis1)), linetype="dashed")
p1
p1=ggplot(SHSU_vol, aes(x=add_0c, y= Axis1, color=sample_site)) +
#scale_y_continuous(breaks=pretty_breaks()) +
#stat_summary(geom="errorbar", fun.data=mean_se, width=0, orientation="x") +
#stat_summary(geom="line", fun.data=mean_se, orientation="x", size=0.5) +
#stat_summary(geom="point", fun.data=mean_se, orientation="x", size=1) +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "ADD", y = "Axis 1 Distance", title="SHSU") +
guides(color = guide_legend(override.aes = list(size=2))) +
theme_bw() +
xlim(0,650) +
theme(axis.text=element_text(size=8),
axis.title.x = element_blank(),
axis.title=element_text(size=9),
plot.title = element_text(size=12, hjust = 0.5),
strip.text = element_text(size=6.5),
legend.text = element_text(size=7),
legend.title = element_text(size=7, hjust = 0.5),
legend.position = c(0.929, 0.22),
legend.direction = "vertical",
legend.key.height = unit(0.01, "cm"),
legend.key.width = unit(0.01, "cm"),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="white")) +
scale_colour_manual(name='Sample Site', values=c('soil.hip'='royalblue3', 'soil.control'='gray20')) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)+2*(sd(SHSU_vol$Axis1)), linetype="dashed") +
geom_hline(yintercept=mean(SHSU_vol$Axis1)-2*(sd(SHSU_vol$Axis1)), linetype="dashed")
p1
p1=ggplot(SHSU_vol, aes(x=add_0c, y= Axis1, color=sample_site)) +
#scale_y_continuous(breaks=pretty_breaks()) +
#stat_summary(geom="errorbar", fun.data=mean_se, width=0, orientation="x") +
#stat_summary(geom="line", fun.data=mean_se, orientation="x", size=0.5) +
stat_summary(geom="point", fun.data=mean_se, orientation="x", size=1) +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "ADD", y = "Axis 1 Distance", title="SHSU") +
guides(color = guide_legend(override.aes = list(size=2))) +
theme_bw() +
xlim(0,650) +
theme(axis.text=element_text(size=8),
axis.title.x = element_blank(),
axis.title=element_text(size=9),
plot.title = element_text(size=12, hjust = 0.5),
strip.text = element_text(size=6.5),
legend.text = element_text(size=7),
legend.title = element_text(size=7, hjust = 0.5),
legend.position = c(0.929, 0.22),
legend.direction = "vertical",
legend.key.height = unit(0.01, "cm"),
legend.key.width = unit(0.01, "cm"),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="white")) +
scale_colour_manual(name='Sample Site', values=c('soil.hip'='royalblue3', 'soil.control'='gray20')) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)+2*(sd(SHSU_vol$Axis1)), linetype="dashed") +
geom_hline(yintercept=mean(SHSU_vol$Axis1)-2*(sd(SHSU_vol$Axis1)), linetype="dashed")
p1
SHSU_vol = read.table("pc_SHSU_vol.tsv", header = TRUE, sep = "\t")
p1=ggplot(SHSU_vol, aes(x=add_0c, y= Axis1, color=sample_site)) +
#scale_y_continuous(breaks=pretty_breaks()) +
#stat_summary(geom="errorbar", fun.data=mean_se, width=0, orientation="x") +
#stat_summary(geom="line", fun.data=mean_se, orientation="x", size=0.5) +
stat_summary(geom="point", fun.data=mean_se, orientation="x", size=1) +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "ADD", y = "Axis 1 Distance", title="SHSU") +
guides(color = guide_legend(override.aes = list(size=2))) +
theme_bw() +
xlim(0,650) +
theme(axis.text=element_text(size=8),
axis.title.x = element_blank(),
axis.title=element_text(size=9),
plot.title = element_text(size=12, hjust = 0.5),
strip.text = element_text(size=6.5),
legend.text = element_text(size=7),
legend.title = element_text(size=7, hjust = 0.5),
legend.position = c(0.929, 0.22),
legend.direction = "vertical",
legend.key.height = unit(0.01, "cm"),
legend.key.width = unit(0.01, "cm"),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="white")) +
scale_colour_manual(name='Sample Site', values=c('soil.hip'='royalblue3', 'soil.control'='gray20')) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)) +
geom_hline(yintercept=mean(SHSU_vol$Axis1)+2*(sd(SHSU_vol$Axis1)), linetype="dashed") +
geom_hline(yintercept=mean(SHSU_vol$Axis1)-2*(sd(SHSU_vol$Axis1)), linetype="dashed")
p1
UTK_vol = read.table("pc_UTK_vol.tsv", header = TRUE, sep = "\t")
p2=ggplot(UTK_vol, aes(x=add_0c, y= Axis1, color=sample_site)) +
#scale_y_continuous(breaks=pretty_breaks()) +
#stat_summary(geom="errorbar", fun.data=mean_se, width=0, orientation="x") +
#stat_summary(geom="line", fun.data=mean_se, orientation="x", size=0.5) +
stat_summary(geom="point", fun.data=mean_se, orientation="x", size=1) +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "ADD", y = "Axis 1 Distance", title="UTK") +
guides(color = guide_legend(override.aes = list(size=2))) +
theme_bw() +
xlim(0,525) +
theme(axis.text=element_text(size=8),
axis.title.x = element_blank(),
axis.title=element_text(size=9),
plot.title = element_text(size=12, hjust = 0.5),
strip.text = element_text(size=6.5),
legend.text = element_text(size=7),
legend.title = element_text(size=7, hjust = 0.5),
legend.position = c(0.929, 0.22),
legend.direction = "vertical",
legend.key.height = unit(0.01, "cm"),
legend.key.width = unit(0.01, "cm"),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="white")) +
scale_colour_manual(name='Sample Site', values=c('soil.hip'='mediumseagreen', 'soil.control'='gray20')) +
geom_hline(yintercept=mean(UTK_vol$Axis1)) +
geom_hline(yintercept=mean(UTK_vol$Axis1)+2*(sd(UTK_vol$Axis1)), linetype="dashed") +
geom_hline(yintercept=mean(UTK_vol$Axis1)-2*(sd(UTK_vol$Axis1)), linetype="dashed")
p2
CMU_vol = read.table("pc_CMU_vol.tsv", header = TRUE, sep = "\t")
p3=ggplot(CMU_vol, aes(x=add_0c, y= Axis1, color=sample_site)) +
#scale_y_continuous(breaks=pretty_breaks()) +
#stat_summary(geom="errorbar", fun.data=mean_se, width=0, orientation="x") +
#stat_summary(geom="line", fun.data=mean_se, orientation="x", size=0.5) +
stat_summary(geom="point", fun.data=mean_se, orientation="x", size=1) +
geom_smooth(method = "lm", se = FALSE) +
labs(x = "ADD", y = "Axis 1 Distance", title="CMU") +
guides(color = guide_legend(override.aes = list(size=2))) +
theme_bw() +
xlim(0,600) +
theme(axis.text=element_text(size=8),
axis.title.x = element_blank(),
axis.title=element_text(size=9),
plot.title = element_text(size=12, hjust = 0.5),
strip.text = element_text(size=6.5),
legend.text = element_text(size=7),
legend.title = element_text(size=7, hjust = 0.5),
legend.position = c(0.929, 0.22),
legend.direction = "vertical",
legend.key.height = unit(0.01, "cm"),
legend.key.width = unit(0.01, "cm"),
panel.grid.minor = element_blank(),
legend.background = element_rect(fill="white")) +
scale_colour_manual(name='Sample Site', values=c('soil.hip'='mediumorchid4', 'soil.control'='gray20')) +
geom_hline(yintercept=mean(CMU_vol$Axis1)) +
geom_hline(yintercept=mean(CMU_vol$Axis1)+2*(sd(CMU_vol$Axis1)), linetype="dashed") +
geom_hline(yintercept=mean(CMU_vol$Axis1)-2*(sd(CMU_vol$Axis1)), linetype="dashed")
p3
p4 = plot_grid(p3 , p1, p2, ncol = 1, nrow = 3)
p4
save_plot("vol_multiplot.png", p4, base_height = 5, base_width = 6, dpi=600)
